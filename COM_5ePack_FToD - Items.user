<?xml version="1.0" encoding="UTF-8"?>
<document signature="Hero Lab Data">
  <thing id="io5CDrhdBlt1" name="Dragonhide Belt +1" description="While wearing this finely detailed belt, you gain a +1 bonus to the saving throw DCs of your ki features. \n\nAlso, you can use an action to regain ki points equaling one roll of your Martial Arts die. You can&apos;t use this action again until the next dawn.\n\n{b}Hero Lab Note:{/b} Monk&apos;s ki save DC&apos;s are not tracked in a central location, so all abilties that use it calculate the value on their own. You will need to add the bonus yourself when providing the save DC for a roll." compset="Wondrous">
    <fieldval field="trkMax" value="1"/>
    <fieldval field="miAttunTxt" value="by a monk"/>
    <usesource source="5eFFToD"/>
    <tag group="Helper" tag="EquipAvail"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Helper" tag="EquipMag"/>
    <tag group="Usage" tag="Day"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="Helper" tag="ShowSpec"/>
    <tag group="ItemRarity" tag="Uncommon"/>
    <tag group="GearType" tag="gtWondrous"/>
    <tag group="LvNamePar" tag="AppText"/>
    <eval phase="Final" priority="10000"><![CDATA[doneif (field[gIsAttuned].value = 0)

field[abText].text = "+1 Ki save DC, " & hero.childfound[cMnkMarArt].field[abText].text & " ki"]]></eval>
    </thing>
  <thing id="io5CDrhdBlt2" name="Dragonhide Belt +2" description="While wearing this finely detailed belt, you gain a +2 bonus to the saving throw DCs of your ki features. \n\nAlso, you can use an action to regain ki points equaling one roll of your Martial Arts die. You can&apos;t use this action again until the next dawn.\n\n{b}Hero Lab Note:{/b} Monk&apos;s ki save DC&apos;s are not tracked in a central location, so all abilties that use it calculate the value on their own. You will need to add the bonus yourself when providing the save DC for a roll." compset="Wondrous">
    <fieldval field="trkMax" value="1"/>
    <fieldval field="miAttunTxt" value="by a monk"/>
    <usesource source="5eFFToD"/>
    <tag group="Helper" tag="EquipAvail"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Helper" tag="EquipMag"/>
    <tag group="Usage" tag="Day"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="Helper" tag="ShowSpec"/>
    <tag group="ItemRarity" tag="Rare"/>
    <tag group="GearType" tag="gtWondrous"/>
    <tag group="LvNamePar" tag="AppText"/>
    <eval phase="Final" priority="10000"><![CDATA[doneif (field[gIsAttuned].value = 0)

field[abText].text = "+2 Ki save DC, " & hero.childfound[cMnkMarArt].field[abText].text & " ki"]]></eval>
    </thing>
  <thing id="io5CDrhdBlt3" name="Dragonhide Belt +3" description="While wearing this finely detailed belt, you gain a +3 bonus to the saving throw DCs of your ki features. \n\nAlso, you can use an action to regain ki points equaling one roll of your Martial Arts die. You can&apos;t use this action again until the next dawn.\n\n{b}Hero Lab Note:{/b} Monk&apos;s ki save DC&apos;s are not tracked in a central location, so all abilties that use it calculate the value on their own. You will need to add the bonus yourself when providing the save DC for a roll." compset="Wondrous">
    <fieldval field="trkMax" value="1"/>
    <fieldval field="miAttunTxt" value="by a monk"/>
    <usesource source="5eFFToD"/>
    <tag group="Helper" tag="EquipAvail"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Helper" tag="EquipMag"/>
    <tag group="Usage" tag="Day"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="Helper" tag="ShowSpec"/>
    <tag group="ItemRarity" tag="VeryRare"/>
    <tag group="GearType" tag="gtWondrous"/>
    <tag group="LvNamePar" tag="AppText"/>
    <eval phase="Final" priority="10000"><![CDATA[doneif (field[gIsAttuned].value = 0)

field[abText].text = "+3 Ki save DC, " & hero.childfound[cMnkMarArt].field[abText].text & " ki"]]></eval>
    </thing>
  <thing id="cfg5CRbyWv" name="Ruby Weave Gem" compset="Configure" uniqueness="unique">
    <fieldval field="cfgMaxSp1" value="1"/>
    <tag group="Helper" tag="SpCountLev"/>
    <eval phase="Final" priority="50000" index="2"><![CDATA[foreach pick in hero from BaseSpell where "hasagent.cfg5CRbyWv"
   perform eachpick.assign[Helper.Memorized]
   perform eachpick.assign[Helper.Free]
   nexteach]]></eval>
    <eval phase="Final" priority="30000"><![CDATA[  var iLev as number

  iLev = hero.childfound[Totals].field[tMaxSpLev].value
  
     field[cfgAllwSp1].text = "component.BaseSpell"

  if (iLev < 1) then
     field[cfgAllwSp1].text &= " & Helper.Helper & !Helper.Helper"
     endif

  if (iLev > 0) then
     field[cfgAllwSp1].text &= " & (sLevel.1"
     endif
  if (iLev > 1) then
     field[cfgAllwSp1].text &= " | sLevel.2"
     endif
  if (iLev > 2) then
     field[cfgAllwSp1].text &= " | sLevel.3"
     endif
  if (iLev > 3) then
     field[cfgAllwSp1].text &= " | sLevel.4"
     endif
  if (iLev > 4) then
     field[cfgAllwSp1].text &= " | sLevel.5"
     endif
  if (iLev > 5) then
     field[cfgAllwSp1].text &= " | sLevel.6"
     endif
  if (iLev > 6) then
     field[cfgAllwSp1].text &= " | sLevel.7"
     endif
  if (iLev > 7) then
     field[cfgAllwSp1].text &= " | sLevel.8"
     endif
  if (iLev > 8) then
     field[cfgAllwSp1].text &= " | sLevel.9"
     endif

  if (iLev > 0) then
     field[cfgAllwSp1].text &= ")"
     endif]]></eval>
    </thing>
  <thing id="i5CTpzAnhl" name="Topaz Annihilator" description="This magic ranged weapon looks like a musket, but instead of ammunition, it has a glowing yellow scale from a topaz dragon in its heart.\n\nThe weapon has a normal range of 100 feet and a long range of 300 feet, and it has the two-handed property. It deals 2d6 necrotic damage on a hit. If this damage reduces a creature or object to 0 hit points, the target disintegrates into dust. A creature reduced to dust can be restored to life only via the {i}true resurrection{/i} or {i}wish{/i} spell.\n\nWhile the weapon is in your possession, you can use an action to cast the {i}disintegrate{/i} spell (save DC 18). Once this feature is used, it can&apos;t be used again until the next dawn." compset="MagicWep" stacking="never">
    <fieldval field="miTypeDet" value="Firearm"/>
    <usesource source="5eFFToD"/>
    <tag group="ItemRarity" tag="Legendary"/>
    <tag group="Helper" tag="ShowSpec"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="Helper" tag="AlwaysAvl"/>
    <bootstrap thing="spDisinteg">
      <containerreq phase="First" priority="2000"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      <autotag group="Usage" tag="LongRest"/>
      <autotag group="Helper" tag="ItemSpell"/>
      <assignval field="trkMax" value="1"/>
      <assignval field="sNameMod" value="DC 18"/>
      </bootstrap>
    <child entity="wSpecMagic">
      <bootstrap thing="w5CTpzAn"></bootstrap>
      </child>
    </thing>
  <thing id="w5CTpzAn" name="Topaz Annihilator" compset="Weapon">
    <fieldval field="wDieCount" value="2"/>
    <fieldval field="wDieSize" value="6"/>
    <fieldval field="wRangeNorm" value="100"/>
    <fieldval field="wRangeLong" value="300"/>
    <usesource source="5eFFToD"/>
    <tag group="wProperty" tag="TwoHanded" name="Two-Handed" abbrev="Two-Handed"/>
    <tag group="wProfReq" tag="Special"/>
    <tag group="Helper" tag="Helper"/>
    <tag group="Helper" tag="Always2H" name="Always2H" abbrev="Always2H"/>
    <tag group="DamageType" tag="dtNecrotic"/>
    <tag group="wCategory" tag="RangeProj"/>
    <tag group="wCategory" tag="Firearm"/>
    <tag group="wGroup" tag="Firearm"/>
    <tag group="Helper" tag="NoSelect"/>
    </thing>
  <thing id="io5CAmyLdstn" name="Amethyst Lodestone" description="While you are carrying this lodestone, you have advantage on Strength saving throws.\n\nThe lodestone has 6 charges for these properties, which you can use while holding the stone. The stone regains 1d6 spent charges each dawn.\n{b}Flight.{/b} As a bonus action, you can spend 1 charge to gain the ability to fly for 10 minutes. For the duration, you gain a flying speed equal to your walking speed, and you can hover.\n{b}Gravitational Thrust.{/b} As an action, you can spend 1 charge to focus gravity around a creature you can see within 60 feet of you. The target must succeed on a DC 18 Strength save or be pushed up to 20 feet in a direction of your choice.\n{b}Reverse Gravity.{/b} As an action, you can spend 3 charges to cast {i}reverse gravity{/i} from the stone (save DC 18)." compset="Wondrous">
    <fieldval field="trkMax" value="6"/>
    <usesource source="5eFFToD"/>
    <tag group="Helper" tag="EquipMag"/>
    <tag group="Helper" tag="EquipAvail"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Usage" tag="Charges"/>
    <tag group="LvNamePar" tag="AppText"/>
    <tag group="SpInfo" tag="spReveGrav"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="ItemRarity" tag="VeryRare"/>
    <tag group="GearType" tag="gtWondrous"/>
    <bootstrap thing="spReveGrav">
      <autotag group="Helper" tag="ItemSpell"/>
      </bootstrap>
    <eval phase="PreLevel" priority="10000"><![CDATA[doneif (field[gIsEquip].value = 0)
      field[abText].text = "regains 1d6 at dawn"
      #situational[hero.child[svSTR],"Advantage",field[thingname].text]
      perform assign[Helper.ShowSpec]]]></eval>
    </thing>
  <thing id="i5CCrysBld" name="Crystal Blade" description="This magic sword&apos;s blade is made from a part of a crystal dragon. When you hit with an attack roll using this sword, the target takes an additional 1d8 radiant damage.\n\nThe sword has 3 charges and regains 1d3 spent charges each dawn. When you hit a creature with an attack roll using the sword, you can spend 1 charge to regain a number of hit points equaling the extra radiant damage the sword dealt.\n\nWhile you&apos;re holding the sword, you can use a bonus action to cause it to shed bright light in a 30-foot radius and dim light for another 30 feet, to cause it to shed dim light in a 10-foot radius, or to douse the light." compset="MagicWep">
    <fieldval field="wDamExtra" value=" + 1d8 radiant"/>
    <fieldval field="trkMax" value="3"/>
    <usesource source="5eFFToD"/>
    <tag group="ItemRarity" tag="Rare"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="Usage" tag="Charges"/>
    <tag group="LvNamePar" tag="AppText"/>
    <eval phase="Final" priority="20000" index="7"><![CDATA[
      ~restrict the list of weapons to valid ones only
      gizmo.child[gCustMagic].field[gItemExpr].text = #magicgearexpr[] & " & (wGroup.Sword)"

      ~set our name based on the type of weapon chosen
      field[livename].text = "Crystal "
      perform gizmo.findchild[BaseWep].setfocus
      if (state.isfocus <> 0) then
        field[livename].text &= titlecase(focus.field[name].text)
      else
        field[livename].text &= "Blade"
        endif
      field[shortname].text = field[livename].text
      field[sbName].text = field[livename].text

    doneif (field[gIsAttuned].value = 0)

      field[abText].text = "regains 1d3 at dawn"]]>
      <after name="gItemExpr Set"/>
      </eval>
    <child entity="gMagWeapon"></child>
    </thing>
  <thing id="i5CDrWngBw" name="Dragon Wing Bow" description="This bow is infused with the essence of a dragon&apos;s breath. When you hit with an attack roll using this magic bow, the target takes an extra 1d6 damage of the same type as the breath infused in the bowâ€”acid, cold, fire, force, lightning, necrotic, poison, psychic, radiant, or thunder.\n\nIf you&apos;re not using ammunition with the weapon, it produces its own, automatically creating one piece of magic ammunition when you draw the string. The ammunition created by the bow vanishes immediately after it hits or misses a target." compset="MagicWep">
    <arrayval field="usrArray" index="0" value="Acid"/>
    <arrayval field="usrArray" index="1" value="Cold"/>
    <arrayval field="usrArray" index="2" value="Fire"/>
    <arrayval field="usrArray" index="3" value="Force"/>
    <arrayval field="usrArray" index="4" value="Lightning"/>
    <arrayval field="usrArray" index="5" value="Necrotic"/>
    <arrayval field="usrArray" index="6" value="Poison"/>
    <arrayval field="usrArray" index="7" value="Psychic"/>
    <arrayval field="usrArray" index="8" value="Radiant"/>
    <arrayval field="usrArray" index="9" value="Thunder"/>
    <usesource source="5eFFToD"/>
    <tag group="ItemRarity" tag="Rare"/>
    <tag group="Helper" tag="ActivMenu"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="User" tag="NoAutoName"/>
    <eval phase="First" index="8"><![CDATA[    doneif (field[gIsAttuned].value = 0)

    field[wDamExtra].text = " + 1d6 "

    if (field[usrIndex].value = 0) then
       field[wDamExtra].text &= "acid"
    elseif (field[usrIndex].value = 1) then
       field[wDamExtra].text &= "cold"
    elseif (field[usrIndex].value = 2) then
       field[wDamExtra].text &= "fire"
    elseif (field[usrIndex].value = 3) then
       field[wDamExtra].text &= "force"
    elseif (field[usrIndex].value = 4) then
       field[wDamExtra].text &= "lightning"
    elseif (field[usrIndex].value = 5) then
       field[wDamExtra].text &= "necrotic"
    elseif (field[usrIndex].value = 6) then
       field[wDamExtra].text &= "poison"
    elseif (field[usrIndex].value = 7) then
       field[wDamExtra].text &= "psychic"
    elseif (field[usrIndex].value = 8) then
       field[wDamExtra].text &= "radiant"
    elseif (field[usrIndex].value = 9) then
       field[wDamExtra].text &= "thunder"
    endif]]></eval>
    <eval phase="Final" priority="20000" index="7"><![CDATA[
      ~restrict the list of weapons to valid ones only
      gizmo.child[gCustMagic].field[gItemExpr].text = #magicgearexpr[] & " & (wGroup.Crossbow | thingid.wLongbow | thingid.wShortbow | thingid.w5CLiReCro | thingid.w5COvrLngbw)"

      ~set our name based on the type of weapon chosen
      field[livename].text = "Dragon Wing "
      perform gizmo.findchild[BaseWep].setfocus
      if (state.isfocus <> 0) then
        field[livename].text &= titlecase(focus.field[name].text)
      else
        field[livename].text &= "Weapon"
        endif
      field[shortname].text = field[livename].text
      field[sbName].text = field[livename].text]]>
      <after name="gItemExpr Set"/>
      </eval>
    <child entity="gMagWeapon"></child>
    </thing>
  <thing id="i5CDrgLnc" name="Dragonlance" description="You gain a +3 bonus to attack and damage rolls made with this magic weapon.\n\nWhen you hit a Dragon with this weapon, the Dragon takes an additional 3d6 force damage, and any Dragon of your choice that you can see within 30 feet of you can immediately use its reaction to make a melee attack." compset="MagicWep">
    <comment><![CDATA[     ~set our name based on the type of weapon chosen
      field[livename].text = "Dragon Wing "
      perform gizmo.findchild[BaseWep].setfocus
      if (state.isfocus <> 0) then
        field[livename].text &= titlecase(focus.field[name].text)
      else
        field[livename].text &= "Weapon"
        endif
      field[shortname].text = field[livename].text
      field[sbName].text = field[livename].text]]></comment>
    <fieldval field="Bonus" value="3"/>
    <usesource source="5eFFToD"/>
    <tag group="ItemRarity" tag="Legendary"/>
    <tag group="Helper" tag="NeedAttune"/>
    <eval phase="Final" priority="20000" index="2"><![CDATA[
      ~restrict the list of weapons to valid ones only
      gizmo.child[gCustMagic].field[gItemExpr].text = #magicgearexpr[] & " & (thingid.wPike | thingid.wLance)"]]></eval>
    <eval phase="PreLevel" priority="10000">doneif (field[gIsEquip].value = 0)

      perform assign[Helper.ShowSpec]</eval>
    <child entity="gMagWeapon"></child>
    </thing>
  <thing id="io5CEmldPen" name="Emerald Pen" description="This pen&apos;s nip is made of emerald. It needs no ink to write. While holding this pen, you can cast {i}illusory script{/i} at will, needing no material components." compset="Wondrous">
    <usesource source="5eFFToD"/>
    <tag group="ItemRarity" tag="Uncommon"/>
    <tag group="GearType" tag="gtWondrous"/>
    <tag group="Helper" tag="EquipAvail"/>
    <tag group="Helper" tag="EquipMag"/>
    <bootstrap thing="spIlluScri">
      <autotag group="Helper" tag="ItemSpell"/>
      <autotag group="Usage" tag="AtWill"/>
      </bootstrap>
    </thing>
  <thing id="i5CFlTiam" name="Flail of Tiamat" description="This magic flail&apos;s five, jagged heads evoke the image of the Dragon Queen. You gain a +3 bonus to attack and damage rolls made with this flail. When you hit with an attack roll using it, the target takes an extra 5d4 damage of your choice of one of the following damage types: acid, cold, fire, lightning, or poison.\n\nWhile holding the flail, you can use an action and speak a command word, which causes the heads to breathe multicolored flames in a 90-foot cone. Each creature in that area must make a DC 18 Dexterity save. On a failed save, it takes 49 (14d6) damage of one of the aforementioned damage types. On a successful save, it takes half as much damage. Once this action is used, it can&apos;t be used again until the next dawn." compset="MagicWep">
    <fieldval field="trkMax" value="1"/>
    <fieldval field="Bonus" value="3"/>
    <fieldval field="gWeight" value="2"/>
    <fieldval field="wDamExtra" value=" + 5d4 acid, cold, fire, lightning, or poison"/>
    <usesource source="5eFFToD"/>
    <tag group="Usage" tag="Day"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="ItemRarity" tag="Legendary"/>
    <tag group="User" tag="Tracker"/>
    <tag group="LvNamePar" tag="AppText"/>
    <eval phase="PreLevel" priority="10000"><![CDATA[doneif (field[gIsEquip].value = 0)
      perform assign[Helper.ShowSpec]
      field[abText].text = "DC 18 Dex, 14d6"]]></eval>
    <child entity="mSpecMagic">
      <bootstrap thing="wFlail"></bootstrap>
      </child>
    </thing>
  <thing id="io5CGldCnry" name="Figurine of Wondrous Power, Gold Canary" description="This gold statuette is carved to look like a canary and is small enough to fit in your pocket. If you use an action to speak the command word and throw the figurine to a point on the ground within 60 feet of you, the figurine becomes a living creature in your choice of one of the following two forms. If there isn&apos;t enough space for the creature where it would appear, the figurine doesn&apos;t become a creature. The two forms are:\n\n{b}Giant Canary Form.{/b} The figurine becomes a giant canary for up to 8 hours, which can be ridden as a mount. Once the figurine has become a giant canary, it can&apos;t be used this way again until the following dawn.\n\n{b}Gold Dragon Form.{/b} If you are missing half or more of your hit points, you can speak a different command word and the figurine becomes an adult gold dragon (see the Monster Manual for its stat block) for up to 1 hour. The dragon can&apos;t use any legendary or lair actions. Once the figurine has become an adult gold dragon, it can&apos;t be used this way again until 1 year has passed.\n\nIn either form, the creature is friendly to you and your allies. It understands your languages and obeys your spoken commands. If you issue no commands, the creature defends itself but doesn&apos;t take other actions.\n\nAt the end of the described duration, the creature reverts to its figurine form. It reverts to a figurine early if it drops to 0 hit points or if you use an action to touch it and speak the command word again. When the creature becomes a figurine again, it cannot be used again in that way until the specified amount of time has passed." compset="Wondrous">
    <usesource source="5eFFToD"/>
    <tag group="ItemRarity" tag="Legendary"/>
    <tag group="GearType" tag="gtWondrous"/>
    <tag group="Helper" tag="AlwaysAvl"/>
    <bootstrap thing="trk5CGldCnDrg"></bootstrap>
    <bootstrap thing="trk5CGldCnCnr"></bootstrap>
    </thing>
  <thing id="trk5CGldCnDrg" name="Gold Canary Figurine (Dragon Form)" description="See the Gold Canary Figurine of Wondrous Power&apos;s description for details." compset="Tracker">
    <fieldval field="trkMax" value="1"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Usage" tag="Year" name="/year"/>
    </thing>
  <thing id="io5CPltScrf" name="Platinum Scarf" description="As an action, you can pull a platinum-colored scale from the scarf, which is covered in them, and speak a command word. When you do so, choose one of these effects:\n{b}Breath of Life.{/b} The scale disappears, and creature you touch (it can be yourself) regains 10d4 hit points.\n{b}Platinum Shield.{/b} For 1 hour or until you dismiss it (no action needed), the scale becomes a +1 shield, which you or another creature can use. A creature wielding the shield is immune to radiant damage.\n{b}Radiant Hammer.{/b} For 1 hour or until you dismiss it (no action needed), the scale becomes a magical light hammer, which you or another creature can use. The weapon deals 2d4 radiant damage, instead of the bludgeoning damage normal for a light hammer. It deals an additional 2d4 radiant damage to chromatic dragons.\n\nOnce three scales have been pulled from the scarf, no more scales can be removed until the following dawn, when any missing scales grow back. If you pull off a scale but don&apos;t speak a command word, it disappears after 1 minute." compset="Wondrous">
    <fieldval field="trkMax" value="3"/>
    <usesource source="5eFFToD"/>
    <tag group="Helper" tag="EquipMag"/>
    <tag group="Helper" tag="EquipAvail"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Usage" tag="Day"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="ItemRarity" tag="Legendary"/>
    <tag group="GearType" tag="gtWondrous"/>
    </thing>
  <thing id="io5CRbyWvGm" name="Ruby Weave Gem" description="While you are holding this gem, you can use it as a spellcasting focus for your spells.\n\nThe gem has 3 charges and regains all spent charges each dawn. When you cast a spell while holding this gem, you can spend up to 3 charges to ignore the spell&apos;s material components with a gold piece cost, up to 500 gp per charge used.\n\nWhen you complete a long rest, choose a spell from any class list. The spell you choose must be of a level you can cast. You know the chosen spell and can cast it with your spell slots of the appropriate level until the end of your next long rest." compset="Wondrous">
    <fieldval field="miAttunTxt" value="requires attunement by a spellcaster"/>
    <fieldval field="trkMax" value="3"/>
    <usesource source="5eFFToD"/>
    <tag group="Custom" tag="5CEbArcFoc"/>
    <tag group="ItemRarity" tag="Legendary"/>
    <tag group="GearType" tag="gtWondrous"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="Usage" tag="Charges"/>
    <bootstrap thing="cfg5CRbyWv">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <eval phase="First"><![CDATA[doneif (field[gIsAttuned].value = 0)
      field[abText].text = "regains 1d3 at dawn"
      perform assign[Helper.ShowSpec]]]></eval>
    </thing>
  <thing id="i5CSphBckl" name="Sapphire Buckler" description="While wielding this crystalline blue shield, you are resistant to psychic and thunder damage. Additionally, when you take damage from a creature that is within 5 feet of you, you can use your reaction to deal 2d6 thunder damage to that creature.\n\nAs an action, you can use the shield to help you find Aberrations until the end of your next turn. If any Aberrations are within 1 mile of you, the shield hums a low tone for a moment, and you know the direction of all Aberrations within that range. Once this property is used, it can&apos;t be used again until the following dawn." compset="MagicArmor">
    <fieldval field="trkMax" value="1"/>
    <fieldval field="gWeight" value="6"/>
    <usesource source="5eFFToD"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Usage" tag="Day"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="ItemRarity" tag="VeryRare"/>
    <eval phase="PreLevel" priority="10000">doneif (field[gIsEquip].value = 0)
doneif (field[gIsAttuned].value = 0)


      perform assign[Helper.ShowSpec]
      perform hero.assign[DamageRes.dtThunder]
      perform hero.assign[DamageRes.dtPsychic]</eval>
    <child entity="mSpecMagic">
      <bootstrap thing="mShield"></bootstrap>
      </child>
    </thing>
  <thing id="trk5CGldCnCnr" name="Gold Canary Figurine (Canary Form)" description="See the Gold Canary Figurine of Wondrous Power&apos;s description for details." compset="Tracker">
    <fieldval field="trkMax" value="1"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Usage" tag="Day"/>
    </thing>
  <thing id="ip5CPtDrgMj" name="Potion of Dragon&apos;s Majesty" description="This potion looks like liquid gold, in which a single scale from a chromatic, gem, or metallic dragon is suspended. When you drink this potion, you transform into an adult dragon of the same kind as the dragon the scale came from. The transformation lasts for 1 hour. Any of your worn or carried equipment melds into your new form or falls to the ground (your choice). For the duration, you use the stat block of the adult dragon instead of your own statistics, but you keep your languages, personality, and memories. You can&apos;t use the dragon form&apos;s Change Shape ability or and of it legendary or lair actions." compset="Potion">
    <usesource source="5eFFToD"/>
    <tag group="ItemRarity" tag="Legendary"/>
    </thing>
  <thing id="c5CHrdState" name="State" description="The power of a hoard magic item depends on the age of the dragon in whose hoard it resided, as well as how long it steeped in the magic of the hoard." compset="CustomSpec" summary="The amount of power in the hoard item.">
    <arrayval field="usrArray" index="0" value="Slumbering"/>
    <arrayval field="usrArray" index="1" value="Stirring"/>
    <arrayval field="usrArray" index="2" value="Wakened"/>
    <arrayval field="usrArray" index="3" value="Ascendant"/>
    <tag group="Helper" tag="Primary"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="CustTaken" tag="cfg5CHrdItem"/>
    <tag group="User" tag="NoAutoName"/>
    <eval phase="First" priority="101"><![CDATA[field[livename].text = field[name].text & " (" & root.field[name].text & ")"

var iNam as string
var iLvl as number

perform root.delete[ItemRarity.?]



if (field[usrIndex].value = 0) then
   iNam = "Slumbering"
   iLvl = 1
   perform root.assign[ItemRarity.Uncommon]
elseif (field[usrIndex].value = 1) then
   iNam = "Stirring"
   iLvl = 2
   perform root.assign[ItemRarity.Rare]
elseif (field[usrIndex].value = 2) then
   iNam = "Wakened"
   iLvl = 3
   perform root.assign[ItemRarity.VeryRare]
elseif (field[usrIndex].value = 3) then
   iNam = "Ascendant"
   iLvl = 4
   perform root.assign[ItemRarity.Legendary]
endif

   iNam = iNam & " " & root.field[thingname].text

root.field[abValue5].value = iLvl
root.field[livename].text = iNam
root.field[sbName].text = iNam
root.field[shortname].text = iNam]]></eval>
    </thing>
  <thing id="c5CHrdQuirk" name="Draconic Quirk" description="Hoard items often carry additional power beyond their regular features, no matter what state they&apos;re in. Roll 1d8 and choose from the menu which quirk your item has.\n\n{b}1:{/b} While resting on the ground, the item points towards the last hoard from which it drew magic.\n{b}2:{/b} The item&apos;s user knows Draconic.\n{b}3:{/b} The item softly glows when within 60 feet of a Dragon or another hoard magic item.\n{b}4:{/b} The item&apos;s user has a swim speed matching their walking speed.\n{b}5:{/b} The item&apos;s user has advantage on Intelligence (History) checks.\n{b}6:{/b} The item&apos;s user has advantage on Charisma (Intimidation) checks versus non-Dragons.\n{b}7:{/b} The item&apos;s user has resistance to the type of damage made by the breath weapon of the dragon whose hoard the item was last steeped in.\n{b}8:{/b} The item&apos;s user has dreams about the dragon whose hoard the item was last steeped in." compset="CustomSpec" summary="A minor additional power from the dragon&apos;s hoard.">
    <arrayval field="usrArray" index="0" value="Points to hoard"/>
    <arrayval field="usrArray" index="1" value="Knows Draconic"/>
    <arrayval field="usrArray" index="2" value="Soft glow"/>
    <arrayval field="usrArray" index="3" value="Swimming speed"/>
    <arrayval field="usrArray" index="4" value="History advantage"/>
    <arrayval field="usrArray" index="5" value="Intimidation advantage"/>
    <arrayval field="usrArray" index="6" value="Damage resistance"/>
    <arrayval field="usrArray" index="7" value="Dreams"/>
    <tag group="CustTaken" tag="cfg5CHrdItem"/>
    <tag group="Helper" tag="Primary"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="User" tag="NoAutoName"/>
    <tag group="Hide" tag="Statblock"/>
    <bootstrap thing="lDraconic">
      <containerreq phase="First" priority="150">fieldval:usrIndex = 1</containerreq>
      </bootstrap>
    <bootstrap thing="xSwim">
      <containerreq phase="First" priority="150">fieldval:usrIndex = 3</containerreq>
      <autotag group="Value" tag="1"/>
      </bootstrap>
    <eval phase="First" priority="101"><![CDATA[hero.childfound[cfg5CHrdItem].field[cfgMax1].value += 1
hero.childfound[cfg5CHrdItem].field[cfgSpent1].value += 1

field[livename].text = field[name].text & " (" & root.field[name].text & ")"]]></eval>
    <eval phase="Final" priority="100002" index="2"><![CDATA[if (field[usrIndex].value = 0) then
      root.field[CustDesc].text = root.field[CustDesc].text & "\n\n{b}Draconic Quirk.{/b} While resting on the ground, the item points towards the last hoard from which it drew magic."
elseif (field[usrIndex].value = 1) then
      root.field[CustDesc].text = root.field[CustDesc].text & "\n\n{b}Draconic Quirk.{/b} The item's user knows Draconic."
elseif (field[usrIndex].value = 2) then
      root.field[CustDesc].text = root.field[CustDesc].text & "\n\n{b}Draconic Quirk.{/b} The item softly glows when within 60 feet of a Dragon or another hoard magic item."
elseif (field[usrIndex].value = 3) then
      root.field[CustDesc].text = root.field[CustDesc].text & "\n\n{b}Draconic Quirk.{/b} The item's user has a swim speed matching their walking speed."
elseif (field[usrIndex].value = 4) then
      root.field[CustDesc].text = root.field[CustDesc].text & "\n\n{b}Draconic Quirk.{/b} The item's user has advantage on Intelligence (History) checks."
elseif (field[usrIndex].value = 5) then
      root.field[CustDesc].text = root.field[CustDesc].text & "\n\n{b}Draconic Quirk.{/b} The item's user has advantage on Charisma (Intimidation) checks versus non-Dragons."
elseif (field[usrIndex].value = 6) then
      root.field[CustDesc].text = root.field[CustDesc].text & "\n\n{b}Draconic Quirk.{/b} The item's user has resistance to the type of damage made by the breath weapon of the dragon whose hoard the item was last steeped in."
elseif (field[usrIndex].value = 7) then
      root.field[CustDesc].text = root.field[CustDesc].text & "\n\n{b}Draconic Quirk.{/b} The item's user has dreams about the dragon whose hoard the item was last steeped in."
endif]]></eval>
    <eval phase="Final" priority="10001" index="3"><![CDATA[if (field[usrIndex].value = 3) then
     hero.childfound[xSwim].field[abValue].value = maximum(hero.childfound[Speed].field[tSpeedMod].value,hero.childfound[xSwim].field[abValue].value)
elseif (field[usrIndex].value = 4) then
     #situational[hero.child[skHistory], "Advantage", field[thingname].text]
elseif (field[usrIndex].value = 5) then
     #situational[hero.child[skIntim], "Advantage vs. non-Dragons", field[thingname].text]
elseif (field[usrIndex].value = 6) then
     perform root.pulltags[DamageRes.?]
     perform hero.pushtags[DamageRes.?]
endif]]></eval>
    </thing>
  <thing id="c5CHrdDmTyp" name="Dragon&apos;s Damage Type" description="Some features of hoard magic items and their draconic quirks depend on the damage type of the dragon in whose hoard the item was steeped. Select the damage type from the drop-down.\n\n{b}Acid damage dragons:{/b} Black, Copper\n{b}Cold damage dragons:{/b} Silver, White\n{b}Fire damage dragons:{/b} Brass, Gold, Red\n{b}Force damage dragons:{/b} Amethyst\n{b}Lightning damage dragons:{/b} Blue, Bronze\n{b}Necrotic damage dragons:{/b} Topaz\n{b}Poison damage dragons:{/b} Green\n{b}Psychic damage dragons:{/b} Emerald\n{b}Radiant damage dragons:{/b} Crystal\n{b}Thunder damage dragons:{/b} Sapphire" compset="CustomSpec" summary="The damage type of the dragon in whose hoard the item originated.">
    <fieldval field="usrCandid1" value="thingid.dtAcid | thingid.dtCold | thingid.dtFire | thingid.dtForce | thingid.dtLightnin | thingid.dtNecrotic | thingid.dtPoison | thingid.dtPsychic | thingid.dtRadiant | thingid.dtThunder"/>
    <tag group="CustTaken" tag="cfg5CHrdItem"/>
    <tag group="Helper" tag="Primary"/>
    <tag group="ChooseSrc1" tag="Thing"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="User" tag="NoAutoName"/>
    <eval phase="First" priority="101"><![CDATA[field[livename].text = field[name].text & " (" & root.field[name].text & ")"

doneif (field[usrChosen1].ischosen = 0)

perform field[usrChosen1].chosen.pulltags[DamageRes.?]
root.field[abText2].text = lowercase(field[usrChosen1].chosen.field[name].text)
perform root.pushtags[DamageRes.?]]]></eval>
    </thing>
  <thing id="cfg5CHrdItem" name="Hoard Items" compset="Configure" uniqueness="unique">
    <fieldval field="cfgObject1" value="Hoard Item Features"/>
    </thing>
  <thing id="i5CDrgWrth" name="Dragon&apos;s Wrath Weapon" description="This magic weapon is adorned with Draconic accoutrement. It has absorbed the magic of the dragon&apos;s breath, and uses that damage type in its features.\n\n{b}Slumbering (Uncommon).{/b} Whenever you roll a 20 on your attack roll with this weapon, every creature of your choice within 5 feet of your target suffers 5 damage of the dragon&apos;s damage type.\n\n{b}Stirring (Rare).{/b} In addition to the Slumbering property, the weapon gains a +1 bonus to its attack and damage rolls. On a hit, the weapon deals an extra 1d6 damage of the dragon&apos;s damage type.\n\n{b}Wakened (Very Rare).{/b} A Wakened weapon has the Slumbering property and an improved version of the Stirring property. The bonus becomes +2, and the extra damage becomes 2d6. You can also use an action to force every creature in a 30-foot cone to make a DC 16 Dexterity save. A creature suffers 8d6 damage of the dragon&apos;s damage type on a failure, or half that on a success. Once you&apos;ve used this action, you cannot do so again until the next dawn.\n\n{b}Ascendant (Legendary).{/b} The Ascendant weapon has the Slumber property and improved versions of the Stirring and Wakened properties. The bonus becomes +3, the extra damage becomes 3d6, the cone becomes 60 feet, the DC increases to 18, and the damage becomes 12d6." compset="MagicWep" buytemplate="BuyMoney" xactspecial="2">
    <fieldval field="miTypeDet" value="any"/>
    <usesource source="5eFFToD"/>
    <tag group="ItemRarity" tag="Varies"/>
    <tag group="Helper" tag="AlwaysAvl"/>
    <tag group="Helper" tag="NeedAttune"/>
    <bootstrap thing="c5CHrdQuirk">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="c5CHrdDmTyp">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="c5CHrdState">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="cfg5CHrdItem">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="trk5CDrgWrth">
      <containerreq phase="First" priority="1000"><![CDATA[fieldval:abValue5 > 2]]></containerreq>
      </bootstrap>
    <eval phase="Final" priority="100001" index="3"><![CDATA[field[CustDesc].text = "This magic weapon is adorned with Draconic accoutrement. It has absorbed the magic of the dragon's breath, and uses that damage type in its features.\n\n{b}Slumbering.{/b} Whenever you roll a 20 on your attack roll with this weapon, every creature of your choice within 5 feet of your target suffers 5 " & field[abText2].text & " damage."

if (field[abValue5].value > 1) then
   debug "over 1"
   field[CustDesc].text &= "\n\n{b}Stirring.{/b} The weapon has a +" & field[Bonus].value & " bonus to its attack and damage rolls. On a hit, the weapon deals an extra " & field[abValue].value & "d6 " & field[abText2].text & " damage." 
   endif

if (field[abValue5].value = 3) then
   field[CustDesc].text &= "\n\n{b}Wakened.{/b} You can also use an action to force every creature in a 30-foot cone to make a DC 16 Dexterity save. A creature suffers 8d6 " & field[abText2].text & " damage on a failure, or half that on a success. Once you've used this action, you cannot do so again until the next dawn."
   hero.childfound[trk5CDrgWrth].field[CustDesc].text = "You can use an action to force every creature in a 30-foot cone to make a DC 16 Dexterity save. A creature suffers 8d6 " & field[abText2].text & " damage on a failure, or half that on a success. Once you've used this action, you cannot do so again until the next dawn."
   hero.childfound[trk5CDrgWrth].field[livename].text = "Dragon Wrath (DC 16 DEX, 30 ft. cone, 8d6 " & field[abText2].text & ")"
   hero.childfound[trk5CDrgWrth].field[shortname].text = hero.childfound[trk5CDrgWrth].field[livename].text
  endif

if (field[abValue5].value = 4) then
   field[CustDesc].text &= "\n\n{b}Wakened/Ascendant.{/b} You can also use an action to force every creature in a 60-foot cone to make a DC 18 Dexterity save. A creature suffers 12d6 " & field[abText2].text & " damage on a failure, or half that on a success. Once you've used this action, you cannot do so again until the next dawn."
   hero.childfound[trk5CDrgWrth].field[CustDesc].text = "You can use an action to force every creature in a 60-foot cone to make a DC 18 Dexterity save. A creature suffers 12d6 " & field[abText2].text & " damage on a failure, or half that on a success. Once you've used this action, you cannot do so again until the next dawn."
   hero.childfound[trk5CDrgWrth].field[livename].text = "Dragon Wrath (DC 18 DEX, 60 ft. cone, 12d6 " & field[abText2].text & ")"
   hero.childfound[trk5CDrgWrth].field[shortname].text = hero.childfound[trk5CDrgWrth].field[livename].text
  endif]]></eval>
    <eval phase="Final" priority="100001"><![CDATA[var iNam as string

if (field[abValue5].value = 1) then
  iNam = "Slumbering"
elseif (field[abValue5].value = 2) then
  iNam = "Stirring"
elseif (field[abValue5].value = 3) then
  iNam = "Wakened"
elseif (field[abValue5].value = 4) then
  iNam = "Ascendant"
endif

      ~set our name based on the type of weapon chosen
      field[livename].text = iNam & " Dragon's Wrath "
      perform gizmo.findchild[BaseWep].setfocus
      if (state.isfocus <> 0) then
        field[livename].text &= titlecase(focus.field[name].text)
      else
        field[livename].text &= "Weapon"
        endif
      field[shortname].text = field[livename].text
      field[sbName].text = field[livename].text]]>
      <after name="gItemExpr Set"/>
      </eval>
    <eval phase="First" priority="102" index="2"><![CDATA[if (field[abValue5].value > 1) then
   field[Bonus].value += 1
   field[abValue].value += 1
   field[wDamExtra].text = " + " & field[abValue].value & "d6 " & field[abText2].text
  endif
if (field[abValue5].value > 2) then
   field[Bonus].value += 1
   field[abValue].value += 1
   field[wDamExtra].text = " + " & field[abValue].value & "d6 " & field[abText2].text
  endif
if (field[abValue5].value > 3) then
   field[Bonus].value += 1
   field[abValue].value += 1
   field[wDamExtra].text = " + " & field[abValue].value & "d6 " & field[abText2].text
  endif]]></eval>
    <child entity="gMagWeapon"></child>
    </thing>
  <thing id="io5CDrgFocus" name="Dragon-Touched Focus" description="This wondrous item can take the form of any holdable, finely crafted object. It is often adorned with draconic decorations.\n\n{b}Slumbering (Uncommon).{/b} You make initiative rolls with advantage. The focus can be used as a spellcasting focus for any of your spells.\n\n{b}Stirring (Rare).{/b} The focus has the Slumbering property, plus another one depending on what family of dragon whose hoard the focus was last steeped in when it reached the Stirring state (choose in the Hoard Items tab):\n\n{b}{i}Chromatic.{/b}{/i} Whenever you use a spell slot to cast a spell that deals acid, cold, fire, lightning, or poison damage, roll 1d6. Add the result to the total damage roll of the spell.\n{b}{i}Gem.{/b}{/i} Whenever you use a spell slot to cast a spell, you can immediately teleport to an open space that you can see that is within 15 feet of you.\n{b}{i}Metallic.{/b}{/i} When a creature you can see within 30 feet of you rolls a saving throw, you can take a reaction to grant it advantage on the save.\n\n{b}Wakened (Very Rare).{/b} A Wakened focus has the Slumbering and Stirring properties. While you&apos;re holding the Wakened focus, you can use it to cast certain spells. Once the item is used to cast a particular spell, that spell cannot be cast with it again until the following dawn. Which spells it can cast are determined by the family of dragon whose hoard the focus was last steeped in when it reached the Wakened state (choose in the Hoard Items tab):\n\n{b}{i}Chromatic.{/b}{/i} {i}binding ice{/i}, {i}hold monster{/i}\n{b}{i}Gem.{/b}{/i} {i}psychic lance{/i}, {i}telepathic bond{/i}\n{b}{i}Metallic.{/b}{/i} {i}legend lore{/i}, {i}platinum shield{/i}\n\n{b}Ascendant (Legendary).{/b} In addition to the Slumbering, Stirring, and Wakened properties, an Ascendant focus grants an additional benefit. When you cast a spell of 1st level or higher while holding this focus, you can treat the spell as if it is being cast at 9th level (and as if it&apos;s using a 9th-level slot). Once you&apos;ve used this property of the focus, it can&apos;t be used again until you complete a long rest." compset="Wondrous">
    <fieldval field="miAttunTxt" value="requires attunement by a spellcaster"/>
    <usesource source="5eFFToD"/>
    <tag group="GearType" tag="gtWondrous"/>
    <tag group="ItemRarity" tag="Varies"/>
    <tag group="Custom" tag="5CEbArcFoc"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="Helper" tag="EquipMag"/>
    <tag group="Helper" tag="AlwaysAvl"/>
    <bootstrap thing="cfg5CHrdItem">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="c5CHrdDmTyp">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="c5CHrdQuirk">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="c5CDrcFcsSt">
      <containerreq phase="First" priority="150"><![CDATA[fieldval:abValue5 > 1]]></containerreq>
      </bootstrap>
    <bootstrap thing="c5CDrcFcsWk">
      <containerreq phase="First" priority="150"><![CDATA[fieldval:abValue5 > 2]]></containerreq>
      </bootstrap>
    <bootstrap thing="spHoldMons">
      <containerreq phase="First" priority="250">fieldval:abValue4 = 1</containerreq>
      <autotag group="Usage" tag="Day"/>
      <autotag group="Helper" tag="ItemSpell"/>
      <assignval field="trkMax" value="1"/>
      </bootstrap>
    <bootstrap thing="sp5CBndIce">
      <containerreq phase="First" priority="250">fieldval:abValue4 = 1</containerreq>
      <autotag group="Usage" tag="Day"/>
      <autotag group="Helper" tag="ItemSpell"/>
      <assignval field="trkMax" value="1"/>
      </bootstrap>
    <bootstrap thing="spTeleBond">
      <containerreq phase="First" priority="250">fieldval:abValue4 = 2</containerreq>
      <autotag group="Usage" tag="Day"/>
      <autotag group="Helper" tag="ItemSpell"/>
      <assignval field="trkMax" value="1"/>
      </bootstrap>
    <bootstrap thing="sp5CPsyLnc">
      <containerreq phase="First" priority="250">fieldval:abValue4 = 2</containerreq>
      <autotag group="Usage" tag="Day"/>
      <autotag group="Helper" tag="ItemSpell"/>
      <assignval field="trkMax" value="1"/>
      </bootstrap>
    <bootstrap thing="sp5CPltShld">
      <containerreq phase="First" priority="250">fieldval:abValue4 = 3</containerreq>
      <autotag group="Usage" tag="Day"/>
      <autotag group="Helper" tag="ItemSpell"/>
      <assignval field="trkMax" value="1"/>
      </bootstrap>
    <bootstrap thing="spLegeLore">
      <containerreq phase="First" priority="250">fieldval:abValue4 = 3</containerreq>
      <autotag group="Usage" tag="Day"/>
      <autotag group="Helper" tag="ItemSpell"/>
      <assignval field="trkMax" value="1"/>
      </bootstrap>
    <bootstrap thing="trk5CAsDrgTch">
      <containerreq phase="First" priority="1000">fieldval:abValue5 = 4</containerreq>
      </bootstrap>
    <bootstrap thing="c5CHrdState">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <eval phase="Final" priority="100001" index="2"><![CDATA[field[CustDesc].text = "This wondrous item can take the form of any holdable, finely crafted object. It is often adorned with draconic decorations.\n\n{b}Slumbering.{/b} You make initiative rolls with advantage. The focus can be used as a spellcasting focus for any of your spells."


var iStN as string
var iStD as string 
if (field[abValue3].value = 1) then
   iStN = "Chromatic"
   iStD = "Whenever you use a spell slot to cast a spell that deals acid, cold, fire, lightning, or poison damage, roll 1d6. Add the result to the total damage roll of the spell."
elseif (field[abValue3].value = 2) then
   iStN = "Gem"
   iStD = "Whenever you use a spell slot to cast a spell, you can immediately teleport to an open space that you can see that is within 15 feet of you."
elseif (field[abValue3].value = 3) then
   iStN = "Metallic"
   iStD = "When a creature you can see within 30 feet of you rolls a saving throw, you can take a reaction to grant it advantage on the save."
endif

if (field[abValue5].value > 1) then
   field[CustDesc].text &= "\n\n{b}Stirring (" & iStN & ").{/b} " & iStD
   endif


var iWkN as string
var iWkD as string 
if (field[abValue4].value = 1) then
   iWkN = "Chromatic"
   iWkD = "{i}binding ice{/i} and {i}hold monster{/i}"
elseif (field[abValue4].value = 2) then
   iWkN = "Gem"
   iWkD = "{i}psychic lance{/i} and {i}telepathic bond{/i}"
elseif (field[abValue4].value = 3) then
   iWkN = "Metallic"
   iWkD = "{i}legend lore{/i} and {i}platinum shield{/i}"
endif

if (field[abValue5].value > 2) then
   field[CustDesc].text &= "\n\n{b}Wakened (" & iWkN & ").{/b} While you're holding the Wakened focus, you can use it to cast the " & iWkD & " spells. Once the item is used to cast a particular spell, that spell cannot be cast with that spell again until the following dawn."
   endif


if (field[abValue5].value > 3) then
   field[CustDesc].text &= "\n\n{b}Ascendant.{/b} When you cast a spell of 1st level or higher while holding this focus, you can treat the spell as if it is being cast at 9th level (and as if it's using a 9th-level slot). Once you've used this property of the focus, it can't be used again until you complete a long rest." 
  endif]]></eval>
    <eval phase="Final" priority="20000"><![CDATA[      doneif (field[gIsAttuned].value = 0)

#situational[hero.child[Initiative], "Advantage", field[thingname].text]]]></eval>
    </thing>
  <thing id="c5CDrcFcsSt" name="Stirring Draconic Family" description="The power of a {b}dragon-touched focus{/b}&apos;s Stirring trait depends on the family of the dragon in whose hoard it was last steeped when it reached the Stirring stage." compset="CustomSpec" summary="The family of the dragon whose hoard Stirred the ornament.">
    <arrayval field="usrArray" index="0" value="Chromatic"/>
    <arrayval field="usrArray" index="1" value="Gem"/>
    <arrayval field="usrArray" index="2" value="Metallic"/>
    <tag group="Helper" tag="Secondary"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="CustTaken" tag="cfg5CHrdItem"/>
    <tag group="User" tag="NoAutoName"/>
    <eval phase="First" priority="200"><![CDATA[var iLvl as number

if (field[usrIndex].value = 0) then
   iLvl = 1
elseif (field[usrIndex].value = 1) then
   iLvl = 2
elseif (field[usrIndex].value = 2) then
   iLvl = 3
endif

root.field[abValue3].value = iLvl

      hero.childfound[cfg5CHrdItem].field[cfgObject2].text = "Dragon-Touched Focus Features"]]></eval>
    </thing>
  <thing id="c5CDrcFcsWk" name="Wakened Draconic Family" description="The power of a {b}dragon-touched focus{/b}&apos;s Wakened trait depends on the family of the dragon in whose hoard it was last steeped when it reached the Wakened stage." compset="CustomSpec" summary="The family of the dragon whose hoard Wakened the ornament.">
    <arrayval field="usrArray" index="0" value="Chromatic"/>
    <arrayval field="usrArray" index="1" value="Gem"/>
    <arrayval field="usrArray" index="2" value="Metallic"/>
    <tag group="Helper" tag="Secondary"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="CustTaken" tag="cfg5CHrdItem"/>
    <tag group="User" tag="NoAutoName"/>
    <eval phase="First" priority="200">var iLvl as number

if (field[usrIndex].value = 0) then
   iLvl = 1
elseif (field[usrIndex].value = 1) then
   iLvl = 2
elseif (field[usrIndex].value = 2) then
   iLvl = 3
endif

root.field[abValue4].value = iLvl</eval>
    </thing>
  <thing id="trk5CAsDrgTch" name="Ascendant Dragon-Touched Focus" description="When you cast a spell of 1st level or higher while holding the dragon-touched focus, you can treat the spell as if it is being cast at 9th level (and as if it&apos;s using a 9th-level slot). Once you&apos;ve used this property of the focus, it can&apos;t be used again until you complete a long rest." compset="Tracker">
    <fieldval field="trkMax" value="1"/>
    <tag group="Usage" tag="Day"/>
    <tag group="User" tag="Tracker"/>
    </thing>
  <thing id="trk5CDrgWrth" name="Wakened Dragon&apos;s Wrath Weapon" compset="Tracker">
    <fieldval field="trkMax" value="1"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Usage" tag="Day"/>
    </thing>
  <thing id="io5CDrgVessl" name="Dragon Vessel" description="This vessel can be any hand-held container for liquid, such as a potion bottle, a flask, or a waterskin.\n\n{b}Slumbering (Uncommon).{/b} You can use a bonus action to speak a command word, filling the vessel with one liquid of your choice. Once this ability of the vessel is used, it cannot be used again until the following dawn. A potion created in this way loses its magical properties if it is not drunk within 24 hours. For a Stirring vessel, the choices are: ale, olive oil, a potion of healing, or a potion of climbing.\n\n{b}Stirring (Rare).{/b} In addition to the previous options, the vessel can now also create: mead, a potion of fire breath, or a potion of healing (greater).\n\n{b}Wakened (Very Rare).{/b} In addition to the previous options, the vessel can now also create: wine, a potion of flying, or a potion of healing (superior).\n\n{b}Ascendant (Legendary).{/b} In addition to the previous options, the vessel can now also create: whiskey, a potion of dragon&apos;s majesty, or a potion of healing (supreme)." compset="Wondrous">
    <fieldval field="trkMax" value="1"/>
    <arrayval field="usrArray" index="2" value="Olive Oil"/>
    <arrayval field="usrArray" index="3" value="Potion of Climbing"/>
    <arrayval field="usrArray" index="7" value="Potion of Healing"/>
    <arrayval field="usrArray" index="0" value="Ale"/>
    <usesource source="5eFFToD"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="GearType" tag="gtWondrous"/>
    <tag group="ItemRarity" tag="Varies"/>
    <tag group="User" tag="NoAutoName"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Helper" tag="AlwaysAvl"/>
    <tag group="abAction" tag="Bonus"/>
    <tag group="Usage" tag="Day"/>
    <tag group="LvNamePar" tag="AppText"/>
    <bootstrap thing="ipPotFireB">
      <containerreq phase="First" priority="400"><![CDATA[fieldval:usrIndex = 5 & fieldval:gIsAttuned <> 0]]></containerreq>
      <assignval field="sbName" value="Potion of Fire Breath (Dragon Vessel)"/>
      <assignval field="livename" value="Potion of Fire Breath (Dragon Vessel)"/>
      <assignval field="shortname" value="Potion of Fire Breath (Dragon Vessel)"/>
      </bootstrap>
    <bootstrap thing="poFlying">
      <containerreq phase="First" priority="400"><![CDATA[fieldval:usrIndex = 6 & fieldval:gIsAttuned <> 0]]></containerreq>
      <assignval field="sbName" value="Potion of Flying (Dragon Vessel)"/>
      <assignval field="livename" value="Potion of Flying (Dragon Vessel)"/>
      <assignval field="shortname" value="Potion of Flying (Dragon Vessel)"/>
      </bootstrap>
    <bootstrap thing="poHealing">
      <containerreq phase="First" priority="400"><![CDATA[fieldval:usrIndex = 7 & fieldval:gIsAttuned <> 0]]></containerreq>
      <assignval field="sbName" value="Potion of Healing (Dragon Vessel)"/>
      <assignval field="livename" value="Potion of Healing (Dragon Vessel)"/>
      <assignval field="shortname" value="Potion of Healing (Dragon Vessel)"/>
      </bootstrap>
    <bootstrap thing="poGreaHeal">
      <containerreq phase="First" priority="400"><![CDATA[fieldval:usrIndex = 8 & fieldval:gIsAttuned <> 0]]></containerreq>
      <assignval field="sbName" value="Potion of Healing (Greater) (Dragon Vessel)"/>
      <assignval field="livename" value="Potion of Healing (Greater) (Dragon Vessel)"/>
      <assignval field="shortname" value="Potion of Healing (Greater) (Dragon Vessel)"/>
      </bootstrap>
    <bootstrap thing="poSupeHeal">
      <containerreq phase="First" priority="400"><![CDATA[fieldval:usrIndex = 9 & fieldval:gIsAttuned <> 0]]></containerreq>
      <assignval field="sbName" value="Potion of Healing (Superior) (Dragon Vessel)"/>
      <assignval field="livename" value="Potion of Healing (Superior) (Dragon Vessel)"/>
      <assignval field="shortname" value="Potion of Healing (Superior) (Dragon Vessel)"/>
      </bootstrap>
    <bootstrap thing="poSuprHeal">
      <containerreq phase="First" priority="400"><![CDATA[fieldval:usrIndex = 10 & fieldval:gIsAttuned <> 0]]></containerreq>
      <assignval field="sbName" value="Potion of Healing (Supreme) (Dragon Vessel)"/>
      <assignval field="livename" value="Potion of Healing (Supreme) (Dragon Vessel)"/>
      <assignval field="shortname" value="Potion of Healing (Supreme) (Dragon Vessel)"/>
      </bootstrap>
    <bootstrap thing="c5CHrdState">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="cfg5CHrdItem">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="c5CHrdDmTyp">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="c5CHrdQuirk">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="poClimbing">
      <containerreq phase="First" priority="400"><![CDATA[fieldval:usrIndex = 3 & fieldval:gIsAttuned <> 0]]></containerreq>
      <assignval field="sbName" value="Potion of Climbing (Dragon Vessel)"/>
      <assignval field="livename" value="Potion of Climbing (Dragon Vessel)"/>
      <assignval field="shortname" value="Potion of Climbing (Dragon Vessel)"/>
      </bootstrap>
    <bootstrap thing="ip5CPtDrgMj">
      <containerreq phase="First" priority="400"><![CDATA[fieldval:usrIndex = 4 & fieldval:gIsAttuned <> 0]]></containerreq>
      <assignval field="sbName" value="Potion of Dragon&apos;s Majesty (Dragon Vessel)"/>
      <assignval field="livename" value="Potion of Dragon&apos;s Majesty (Dragon Vessel)"/>
      <assignval field="shortname" value="Potion of Dragon&apos;s Majesty (Dragon Vessel)"/>
      </bootstrap>
    <eval phase="Final" priority="100001" index="2">doneif (field[gIsAttuned].value = 0)

field[abText].text = &quot;bonus&quot;

field[CustDesc].text = &quot;This vessel can be any hand-held container for liquid, such as a potion bottle, a flask, or a waterskin.\n\nYou can use a bonus action to speak a command word, filling the vessel with one liquid of your choice. Once this ability of the vessel is used, it cannot be used again until the following dawn. A potion created in this way loses its magical properties if it is not drunk within 24 hours.\n\nThe vessel can be used to create:&quot;

if (field[abValue5].value = 1) then
   field[CustDesc].text &amp;= &quot;\nâ€¢Ale\nâ€¢Olive Oil\nâ€¢Potion of Climbing\nâ€¢Potion of Healing&quot;
elseif (field[abValue5].value = 2) then
   field[CustDesc].text &amp;= &quot;\nâ€¢Ale\nâ€¢Mead\nâ€¢Olive Oil\nâ€¢Potion of Climbing\nâ€¢Potion of Fire Breath\nâ€¢Potion of Healing\nâ€¢Potion of Healing (Greater)&quot;
elseif (field[abValue5].value = 3) then
   field[CustDesc].text &amp;= &quot;\nâ€¢Ale\nâ€¢Mead\nâ€¢Olive Oil\nâ€¢Potion of Climbing\nâ€¢Potion of Fire Breath\nâ€¢Potion of Flying\nâ€¢Potion of Healing\nâ€¢Potion of Healing (Greater)\nâ€¢Potion of Healing (Superior)\nâ€¢Wine&quot;
elseif (field[abValue5].value = 4) then
   field[CustDesc].text &amp;= &quot;\nâ€¢Ale\nâ€¢Mead\nâ€¢Olive Oil\nâ€¢Potion of Climbing\nâ€¢Potion of Dragon&apos;s Majesty\nâ€¢Potion of Fire Breath\nâ€¢Potion of Flying\nâ€¢Potion of Healing\nâ€¢Potion of Healing (Greater)\nâ€¢Potion of Healing (Superior)\nâ€¢Potion of Healing (Supreme)\nâ€¢Whiskey\nâ€¢Wine&quot;
endif</eval>
    <eval phase="First" priority="500"><![CDATA[if (field[abValue5].value > 1) then 
   field[usrArray].arraytext[1] = "Mead"
   field[usrArray].arraytext[5] = "Potion of Fire Breath"
   field[usrArray].arraytext[8] = "Potion of (Greater) Healing"
endif

if (field[abValue5].value > 2) then 
   field[usrArray].arraytext[6] = "Potion of Flying"
   field[usrArray].arraytext[9] = "Potion of (Superior) Healing"
   field[usrArray].arraytext[12] = "Wine"
endif

if (field[abValue5].value > 3) then 
   field[usrArray].arraytext[4] = "Potion of Dragon's Majesty"
   field[usrArray].arraytext[10] = "Potion of (Supreme) Healing"
   field[usrArray].arraytext[11] = "Whiskey"
endif]]></eval>
    </thing>
  <thing id="io5CScldOrn" name="Scaled Ornament" description="This ornament can be most any wearable accessory, fashioned in the form or including the image of a draconic body part.\n\n{b}Slumbering (Uncommon).{/b} You have advantage on saves to avoid or end the charmed and frightened conditions on yourself.\n\n{b}Stirring (Rare).{/b} You gain a +1 bonus to your AC, and are now immune to the charmed and frightened conditions. Additionally, every creature of your choice within 30 feet of you has advantage on saves to avoid or end the charmed and frightened conditions on themselves.\n\n{b}Wakened (Very Rare).{/b} A Wakened ornament has the Stirring property. Additionally, when you would take damage of the same type as the breath weapon of the dragon in whose hoard the ornament became Wakened, you can use your reaction to take no damage. Instead, you regain hit points equaling the amount of damage you would have taken. Once you&apos;ve used this reaction, you cannot do so until the following dawn.\n\n{b}Ascendant (Legendary).{/b} In addition to the Stirring and Wakened properties, the Ascendant ornament grants you flight. While holding the ornament, you have a flight speed equal to your walking speed, and you can hover. While you are flying in this manner, spectral dragon wings sprout from your back." compset="Wondrous">
    <usesource source="5eFFToD"/>
    <tag group="Helper" tag="NeedAttune"/>
    <tag group="GearType" tag="gtWondrous"/>
    <tag group="ItemRarity" tag="Varies"/>
    <tag group="User" tag="NoAutoName"/>
    <tag group="LvNamePar" tag="AppText"/>
    <tag group="Helper" tag="EquipMag"/>
    <tag group="Helper" tag="AlwaysAvl"/>
    <bootstrap thing="c5CHrdDmTyp">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="c5CHrdQuirk">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="c5COrnWkDm">
      <containerreq phase="First" priority="150"><![CDATA[fieldval:abValue5 > 2]]></containerreq>
      </bootstrap>
    <bootstrap thing="c5CHrdState">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="cfg5CHrdItem">
      <containerreq phase="First" priority="100"><![CDATA[fieldval:gIsAttuned <> 0]]></containerreq>
      </bootstrap>
    <bootstrap thing="xFly">
      <containerreq phase="First" priority="200">fieldval:abValue5 = 4</containerreq>
      <autotag group="Value" tag="1"/>
      <autotag group="AbilModify" tag="Hover"/>
      </bootstrap>
    <eval phase="Final" priority="10000"><![CDATA[if (field[abValue5].value = 1) then
      #situational[hero.child[svAll],"Advantage vs. being charmed or frightened",field[thingname].text]
endif]]></eval>
    <eval phase="PreLevel" priority="5000" index="2"><![CDATA[
      doneif (field[abValue5].value < 2)

      hero.child[ArmorClass].field[Bonus].value += 1
      perform hero.assign[CondImm.pcnCharmed]
      perform hero.assign[CondImm.pcnFright]]]></eval>
    <eval phase="First" priority="500" index="3"><![CDATA[doneif (field[abValue5].value < 3)
    field[trkMax].value = 1
    perform assign[User.Tracker]
    perform assign[Usage.Day]
    field[abText].text = "reaction"]]></eval>
    <eval phase="Final" priority="10001" index="5"><![CDATA[field[CustDesc].text = "This ornament can be most any wearable accessory, fashioned in the form or including the image of a draconic body part."

if (field[abValue5].value = 1) then
    field[CustDesc].text &= "\n\n{b}Slumbering.{/b} You have advantage on saves to avoid or end the charmed and frightened conditions on yourself."
	endif

if (field[abValue5].value > 1) then
    field[CustDesc].text &= "\n\n{b}Slumbering/Stirring.{/b} You gain a +1 bonus to your AC, and are immune to the charmed and frightened conditions. Additionally, every creature of your choice within 30 feet of you has advantage on saves to avoid or end the charmed and frightened conditions on themselves."
	endif

if (field[abValue5].value > 2) then
    field[CustDesc].text &= "\n\n{b}Wakened.{/b} When you would take " & field[abText2].text & " damage, you can use your reaction to take no damage. Instead, you regain hit points equaling the amount of damage you would have taken. Once you've used this reaction, you cannot do so until the following dawn."
	endif
	
if (field[abValue5].value > 3) then
    field[CustDesc].text &= "\n\n{b}Ascendant{/b} While holding the ornament, you have a flight speed equal to your walking speed, and you can hover. While you are flying in this manner, spectral dragon wings sprout from your back."
	endif]]></eval>
    <eval phase="Final" priority="10001" index="4"><![CDATA[doneif (field[abValue5].value < 4)    

     hero.childfound[xFly].field[abValue].value = maximum(hero.childfound[Speed].field[tSpeedMod].value,hero.childfound[xFly].field[abValue].value)]]></eval>
    </thing>
  <thing id="c5COrnWkDm" name="Wakened Dragon&apos;s Damage Type" description="The power of a {b}scaled ornament{/b}&apos;s Wakened trait depends on the damage type of the dragon in whose hoard the item was steeped to become Wakened. Select the damage type from the drop-down.\n\n{b}Acid damage dragons:{/b} Black, Copper\n{b}Cold damage dragons:{/b} Silver, White\n{b}Fire damage dragons:{/b} Brass, Gold, Red\n{b}Force damage dragons:{/b} Amethyst\n{b}Lightning damage dragons:{/b} Blue, Bronze\n{b}Necrotic damage dragons:{/b} Topaz\n{b}Poison damage dragons:{/b} Green\n{b}Psychic damage dragons:{/b} Emerald\n{b}Radiant damage dragons:{/b} Crystal\n{b}Thunder damage dragons:{/b} Sapphire" compset="CustomSpec" summary="The damage type of the dragon whose hoard Wakened the ornament.">
    <fieldval field="usrCandid1" value="thingid.dtAcid | thingid.dtCold | thingid.dtFire | thingid.dtForce | thingid.dtLightnin | thingid.dtNecrotic | thingid.dtPoison | thingid.dtPsychic | thingid.dtRadiant | thingid.dtThunder"/>
    <tag group="CustTaken" tag="cfg5CHrdItem"/>
    <tag group="Helper" tag="Tertiary"/>
    <tag group="ChooseSrc1" tag="Thing"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="User" tag="NoAutoName"/>
    <eval phase="First" priority="200"><![CDATA[hero.childfound[cfg5CHrdItem].field[cfgObject3].text = "Scaled Ornament Features"

doneif (field[usrChosen1].ischosen = 0)

root.field[abText2].text = lowercase(field[usrChosen1].chosen.field[name].text)]]></eval>
    </thing>
  </document>
