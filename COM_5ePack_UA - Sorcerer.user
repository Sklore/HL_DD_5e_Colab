<?xml version="1.0" encoding="UTF-8"?>
<document signature="Hero Lab Data">
  <thing id="c5CSorFS02" name="Favored Soul (2)" description="Sometimes the spark of magic that fuels a sorcerer comes from a divine source that glimmers within the soul. Having such a favored soul, your innate magic might come from a distant but powerful familial connection to a divine being. Perhaps your ancestor was an angel, transformed into a mortal and sent to fight in a god’s name. Or your birth might align with an ancient prophecy, marking you as a servant of the gods or a chosen vessel of divine magic.\nFavored souls, with their natural magnetism and strong personalities, are often seen as threats by traditional religious hierarchies. As outsiders who command the power of the gods, these sorcerers can undermine the existing order and claim a direct tie to the divine.\nIn some cultures, only those who can claim the power of a favored soul may command religious power. In these lands, ecclesiastical positions are dominated by a few bloodlines and preserved over generations." compset="CustomSpec" uniqueness="unique">
    <usesource source="p5eSOrUACP" parent="p5eUneArc" name="5e Unearthed Arcana - Sorcerer"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="Helper" tag="Primary"/>
    <tag group="abCategory" tag="c5CSorcOri" name="Sorcerous Origins"/>
    <tag group="SpecSource" tag="cHelpSor"/>
    <bootstrap thing="c5CSorDM01">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="c5CSorSR01">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="c5CSorFG01">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="c5CSorBC01">
      <autotag group="ClSpecWhen" tag="6"/>
      </bootstrap>
    <bootstrap thing="c5CSorDP01">
      <autotag group="ClSpecWhen" tag="14"/>
      </bootstrap>
    <bootstrap thing="c5CSorUR01">
      <autotag group="ClSpecWhen" tag="18"/>
      </bootstrap>
    </thing>
  <thing id="c5CSorFS03" name="Phoenix Sorcery" description="Your power draws from the immortal flame that fuels the legendary phoenix. You or your ancestors perhaps rendered a phoenix a great service, or you were born in its presence. Whatever the cause, a shard of the phoenix’s power dwells within you. \nThat power is a mixed blessing. Like the mythical creature, you can invoke fiery energy and gain the ability to cheat death itself. This power comes at a cost. The fire within you seethes, demanding to be unleashed. You sometimes find yourself absentmindedly feeding fires. You can’t bear to allow a fire to sputter out. You feel most comfortable while holding a lit torch or sitting in front of a campfire. \nMore importantly, this gift comes with no special protection from fire. You are as vulnerable as any other creature to fiery magic, including your own. Phoenix sorcerers can use their powers to pull themselves back from the brink of death, and all too often their own, rash nature or reliance on destructive magic is what puts them there in the first place. \nSuch sorcerers are wanderers by necessity. The volatile nature of their magic makes other folk nervous. If a fire breaks out in town, a phoenix sorcerer had best flee, whether guilty or not. Fire is a dangerous force, and phoenix sorcerers have a reputation (deserved or not)  for reckless behavior, confident that the essence of the phoenix can save them." compset="CustomSpec" uniqueness="unique">
    <usesource source="p5eSOrUACP" parent="p5eUneArc" name="5e Unearthed Arcana - Sorcerer"/>
    <tag group="Helper" tag="SpecUp" name="SpecUp" abbrev="SpecUp"/>
    <tag group="SpecSource" tag="cHelpSor" name="Sorcerer" abbrev="Sorcerer"/>
    <tag group="abCategory" tag="c5CSorcOri" name="Sorcerous Origins" abbrev="Sorcerous Origins"/>
    <tag group="Helper" tag="Primary" name="Primary" abbrev="Primary"/>
    <bootstrap thing="c5CSorIg01">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="c5CSorMF01">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="c5CSorPS01">
      <autotag group="ClSpecWhen" tag="6"/>
      </bootstrap>
    <bootstrap thing="c5CSorNF01">
      <autotag group="ClSpecWhen" tag="14"/>
      </bootstrap>
    <bootstrap thing="c5CSorFP01">
      <autotag group="ClSpecWhen" tag="18"/>
      </bootstrap>
    <eval phase="PostLevel" priority="9000"><![CDATA[doneif (tagis[Helper.Disable] <> 0)

linkage[table].field[cSpec3rdNm].text = "Phoenix Soul Quircks"
linkage[table].field[cSpec3rdSi].text = "Phoenix Soul Quirck"
linkage[table].field[cCustTeTot].arrayvalue[0] += 1]]></eval>
    </thing>
  <thing id="c5CSorSS01" name="Sea Sorcery" description="The power of water is the strength of flexibility, resilience, and a relentless nature. Water parts to allow a ship to sail over it or a diver to plunge into it, but their passing leaves no mark. Water flowing down a mountain reaches the sea. It might bend and turn across valleys and down hillsides, but it slowly and steadily returns to the waves. Those whose souls are touched by the power of elemental water command a similar power.\nYour heritage ties to powerful creatures of the sea, such as nereids, the lords of the merfolk, and elemental powers. Like a river, you feel the call of the ocean. The call is ever present in your heart, and you are never completely at peace until you are near the sea." compset="CustomSpec" uniqueness="unique">
    <usesource source="p5eSOrUACP" parent="p5eUneArc" name="5e Unearthed Arcana - Sorcerer"/>
    <tag group="Helper" tag="SpecUp" name="SpecUp" abbrev="SpecUp"/>
    <tag group="SpecSource" tag="cHelpSor" name="Sorcerer" abbrev="Sorcerer"/>
    <tag group="abCategory" tag="c5CSorcOri" name="Sorcerous Origins" abbrev="Sorcerous Origins"/>
    <tag group="Helper" tag="Primary" name="Primary" abbrev="Primary"/>
    <bootstrap thing="c5CSorSea1">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="c5CSorSea2">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="c5CSorSea3">
      <autotag group="ClSpecWhen" tag="6"/>
      </bootstrap>
    <bootstrap thing="c5CSorSea4">
      <autotag group="ClSpecWhen" tag="14"/>
      </bootstrap>
    <bootstrap thing="c5CSorSea5">
      <autotag group="ClSpecWhen" tag="18"/>
      </bootstrap>
    </thing>
  <thing id="c5CSorSS02" name="Stone Sorcery" description="Your magic springs from a mystical link between your soul and the magic of elemental earth. You might trace a distant ancestor to the Plane of Earth, or your family might have earned a mighty boon in return for a service to the dao lords. Whatever your past, the magic of elemental earth is yours to command.\nYour link to earth magic grants you extraordinary resilience, and stone sorcerers have a natural affinity for combat. A steel blade feels like a natural extension of your body, and sorcerers with this origin have a knack for wielding both shields and weapons. In combat your place is amid the fray. You rely on your elemental nature to shield you from harm and your magic and metal weapons to overwhelm your foes." compset="CustomSpec" uniqueness="unique">
    <usesource source="p5eSOrUACP" parent="p5eUneArc" name="5e Unearthed Arcana - Sorcerer"/>
    <tag group="Helper" tag="SpecUp" name="SpecUp" abbrev="SpecUp"/>
    <tag group="SpecSource" tag="cHelpSor" name="Sorcerer" abbrev="Sorcerer"/>
    <tag group="abCategory" tag="c5CSorcOri" name="Sorcerous Origins" abbrev="Sorcerous Origins"/>
    <tag group="Helper" tag="Primary" name="Primary" abbrev="Primary"/>
    <bootstrap thing="c5CSorSBP1">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="c5CSorSMM1">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="c5CSorSSD1">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="c5CSorSSA1">
      <autotag group="ClSpecWhen" tag="6"/>
      </bootstrap>
    <bootstrap thing="c5CSorSSE1">
      <autotag group="ClSpecWhen" tag="14"/>
      </bootstrap>
    <bootstrap thing="c5CSorSEMA">
      <autotag group="ClSpecWhen" tag="18"/>
      </bootstrap>
    </thing>
  <thing id="c5CSorDM01" name="Divine Magic" description="Your link to the divine allows you to learn spells normally associated with the cleric class. When your Spellcasting feature lets you learn a sorcerer cantrip or a sorcerer spell of 1st level or higher, you can choose the new spell from the cleric spell list, in addition to the sorcerer spell list. You must otherwise obey all the restrictions for selecting the spell, and it becomes a sorcerer spell for you." compset="ClSpecial">
    <eval phase="Final" priority="21000"><![CDATA[doneif (tagis[Helper.ShowSpec] = 0)
doneif (tagis[Helper.Disable] <> 0)

~these vars will hold the tag expressions for spells and cantrips

var cantrip as string
var spell as string
var known as string 

cantrip = hero.childfound[cHelpSor].field[cCnKnoExpr].text
spell = hero.childfound[cHelpSor].field[cSpKnoExpr].text 
known = hero.childfound[cHelpSor].field[cSpellExpr].text 

~ debug "Cantrip: " & cantrip
~ debug "Spell: " & spell
~ debug "Known Spells: " & known

~ now we modify the expression to also include the cleric spells

cantrip = replace(cantrip, "sClass.cHelpSor", "( sClass.cHelpSor | sClass.cHelpClr )", 1)
cantrip = replace(cantrip, "(sClassNot.cHelpSor)", "( sClassNot.cHelpSor | sClassNot.cHelpClr )", 1)

spell = replace(spell, "sClass.cHelpSor", "( sClass.cHelpSor | sClass.cHelpClr )", 1)
spell = replace(spell, "(sClassNot.cHelpSor)", "( sClassNot.cHelpSor | sClassNot.cHelpClr )", 1)

known = replace(known, "sClass.cHelpSor", "( sClass.cHelpSor | sClass.cHelpClr )", 1)
known = replace(known, "(sClassNot.cHelpSor)", "( sClassNot.cHelpSor | sClassNot.cHelpClr )", 1)

~ debug "Cantrip: " & cantrip
~ debug "Spell: " & spell
~ debug "Known Spells: " & known

~finally, we replace the expressions with the new ones

hero.childfound[cHelpSor].field[cCnKnoExpr].text = cantrip
hero.childfound[cHelpSor].field[cSpKnoExpr].text = spell
hero.childfound[cHelpSor].field[cSpellExpr].text = known
hero.childfound[cHelpSor].field[cSplBkExpr].text = known]]></eval>
    </thing>
  <thing id="c5CSorSR01" name="Supernatural Resilience" description="At 1st level, the blessing of the gods grants you enhanced durability. Your hit point maximum increases by 1, and it increases by 1 again whenever you gain a level in this class." compset="ClSpecial" summary="You have a bonus to your HP.">
    <tag group="Helper" tag="SpecUp" name="SpecUp" abbrev="SpecUp"/>
    <tag group="abAction" tag="None" name="No action" abbrev="None"/>
    <tag group="abDuration" tag="Constant" name="Constant" abbrev="cons"/>
    <tag group="abRange" tag="Personal" name="Personal" abbrev="pers"/>
    <eval phase="PostAttr" priority="10000" index="2"><![CDATA[

       doneif (tagis[Helper.ShowSpec] = 0)

       doneif (tagis[Helper.Disable] <> 0)

       herofield[tBonusHP].value += field[abValue].value]]></eval>
    <eval phase="PostLevel" priority="10000">field[abValue].value += field[xAllLev].value</eval>
    </thing>
  <thing id="c5CSorFG01" name="Favored by the Gods" description="Starting at 1st level, divine power guards your destiny. If you fail a saving throw or miss with an attack roll, you can roll 2d4 and add it to the total, possibly changing the outcome.\nOnce you use this feature, you can’t use it again until you finish a short or long rest." compset="ClSpecial">
    <fieldval field="trkMax" value="1"/>
    <fieldval field="abValue" value="2"/>
    <fieldval field="abValue2" value="4"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Usage" tag="ShortRest"/>
    <tag group="LvNamePar" tag="DieCntVal"/>
    <tag group="LvNamePar" tag="DieSizVal2"/>
    </thing>
  <thing id="c5CSorBC01" name="Blessed Countenance" description="At 6th level, your divine essence causes you to undergo a minor physical transformation. Your appearance takes on an otherworldly version of one of the following qualities (your choice): beautiful, youthful, kind, or imposing.\nWhatever your choice, if your proficiency bonus applies to a Charisma check, double that bonus." compset="ClSpecial">
    <tag group="User" tag="Activation"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[doneif (tagis[Helper.Disable] = 1)
doneif (field[abilActive].value = 0)

foreach pick in hero from BaseSkill where hero.tagids[ProfSkill.?, "|"]
   if ( eachpick.tagis[SkillAbil.aCHA] <> 0 ) then
      perform eachpick.pulltags[ProfDouble.?]
   endif
nexteach

perform forward[ProfDouble.?]]]>
      <before name="Calc skProfBon"/>
      </eval>
    </thing>
  <thing id="c5CSorDP01" name="Divine Purity" description="At 14th level, you become immune to disease,  poison damage, and the poisoned condition." compset="ClSpecial" summary="You are immune to disease and poison.">
    <tag group="CondImm" tag="pcnDisease" name="diseased" abbrev="diseased"/>
    <tag group="CondImm" tag="pcnPoison" name="Poisoned" abbrev="Poisoned"/>
    <tag group="Helper" tag="SpecUp" name="SpecUp" abbrev="SpecUp"/>
    <tag group="abAction" tag="None" name="No action" abbrev="None"/>
    <tag group="abDuration" tag="Constant" name="Constant" abbrev="cons"/>
    <tag group="abRange" tag="Personal" name="Personal" abbrev="pers"/>
    <tag group="DamageImm" tag="dtPoison"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      doneif (tagis[Helper.Disable] <> 0)

      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] = 0)

      perform forward[CondImm.?]
      perform forward[DamageImm.?]]]></eval>
    </thing>
  <thing id="c5CSorUR01" name="Unearthly Recovery" description="At 18th level, you gain the ability to overcome grievous injuries. As a bonus action when you have less than half of your hit points remaining, you can regain a number of hit points equal to half your hit point maximum. \nOnce you use this feature, you can’t use it again until you finish a long rest." compset="ClSpecial">
    <fieldval field="trkMax" value="1"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Usage" tag="LongRest"/>
    </thing>
  <thing id="c5CSorPSQ1" name="Fire starter" description="You absentmindedly ignite small fires that quickly sputter out." compset="CustomSpec" uniqueness="unique">
    <tag group="Helper" tag="Tertiary"/>
    <tag group="SpecSource" tag="cHelpSor"/>
    <tag group="abCategory" tag="c5CSorQuir" name="Sorcerer Origin Quirk"/>
    </thing>
  <thing id="c5CSorPSQ2" name="Mad Laughter" description="You cackle like a fiend when you unleash your fire spells." compset="CustomSpec" uniqueness="unique">
    <tag group="Helper" tag="Tertiary" name="Tertiary" abbrev="Tertiary"/>
    <tag group="SpecSource" tag="cHelpSor" name="Sorcerer" abbrev="Sorcerer"/>
    <tag group="abCategory" tag="c5CSorQuir" name="Sorcerer Origin Quirk" abbrev="Sorcerer Origin Quirk"/>
    </thing>
  <thing id="c5CSorPSQ3" name="Fire lover" description="You admire fire, even if it burns your friends." compset="CustomSpec" uniqueness="unique">
    <tag group="Helper" tag="Tertiary" name="Tertiary" abbrev="Tertiary"/>
    <tag group="SpecSource" tag="cHelpSor" name="Sorcerer" abbrev="Sorcerer"/>
    <tag group="abCategory" tag="c5CSorQuir" name="Sorcerer Origin Quirk" abbrev="Sorcerer Origin Quirk"/>
    </thing>
  <thing id="c5CSorPSQ4" name="Marks of the past" description="You are covered in burns that mark the first time your power manifested." compset="CustomSpec" uniqueness="unique">
    <tag group="Helper" tag="Tertiary" name="Tertiary" abbrev="Tertiary"/>
    <tag group="SpecSource" tag="cHelpSor" name="Sorcerer" abbrev="Sorcerer"/>
    <tag group="abCategory" tag="c5CSorQuir" name="Sorcerer Origin Quirk" abbrev="Sorcerer Origin Quirk"/>
    </thing>
  <thing id="c5CSorPSQ5" name="Well done" description="You like your food charred." compset="CustomSpec" uniqueness="unique">
    <tag group="Helper" tag="Tertiary" name="Tertiary" abbrev="Tertiary"/>
    <tag group="SpecSource" tag="cHelpSor" name="Sorcerer" abbrev="Sorcerer"/>
    <tag group="abCategory" tag="c5CSorQuir" name="Sorcerer Origin Quirk" abbrev="Sorcerer Origin Quirk"/>
    </thing>
  <thing id="c5CSorPSQ6" name="Braveheart" description="You are brave to the point of recklessness" compset="CustomSpec" uniqueness="unique">
    <tag group="Helper" tag="Tertiary" name="Tertiary" abbrev="Tertiary"/>
    <tag group="SpecSource" tag="cHelpSor" name="Sorcerer" abbrev="Sorcerer"/>
    <tag group="abCategory" tag="c5CSorQuir" name="Sorcerer Origin Quirk" abbrev="Sorcerer Origin Quirk"/>
    </thing>
  <thing id="c5CSorIg01" name="Ignite" description="At 1st level, you gain the ability to start fires with a touch. As an action, you can magically ignite a flammable object you touch with your hand-an object such as a torch, a piece of tinder, or the hem of drapes." compset="ClSpecial">
    <tag group="abAction" tag="Action"/>
    </thing>
  <thing id="c5CSorMF01" name="Mantle of Flame" description="Starting at 1st level, you can unleash the phoenix fire that blazes within you. \nAs a bonus action, you magically wreathe yourself in swirling fire, as your eyes glow like hot coals. For 1 minute, you gain the following benefits:\n\n•  You shed bright light in a 30-foot radius and dim light for an additional 30 feet.\n•  Any creature takes fire damage equal to your Charisma modifier if it hits you with a melee attack from within 5 feet of you or if it touches you.\n•  Whenever you roll fire damage on your turn, the roll gains a bonus to equal to your Charisma modifier.\n\nOnce you use this feature, you can’t use it again until you finish a long rest." compset="ClSpecial">
    <fieldval field="trkMax" value="1"/>
    <fieldval field="abDuration" value="1"/>
    <tag group="Usage" tag="LongRest"/>
    <tag group="abAction" tag="Bonus"/>
    <tag group="abRange" tag="Personal"/>
    <tag group="User" tag="Tracker"/>
    <tag group="abDuration" tag="Minute"/>
    <tag group="User" tag="Activation"/>
    </thing>
  <thing id="c5CSorPS01" name="Phoenix Spark" description="Starting at 6th level, the fiery energy within you grows restless and vengeful. In the face of defeat, it surges outward to preserve you in a fiery roar.\nIf you are reduced to 0 hit points, you can use your reaction to draw on the spark of the phoenix. You are instead reduced to 1 hit point, and each creature within 10 feet of you takes fire damage equal to half your sorcerer level + your Charisma modifier.\nIf you use this feature while under the effects of your Mantle of Flame, this feature instead deals fire damage equal to your sorcerer level + double your Charisma modifier, and your Mantle of Flame immediately ends.\nOnce you use this feature, you can’t use it again until you finish a long rest." compset="ClSpecial">
    <fieldval field="abRange" value="10"/>
    <fieldval field="trkMax" value="1"/>
    <tag group="abRange" tag="Feet"/>
    <tag group="User" tag="Tracker"/>
    <tag group="abAction" tag="Reaction"/>
    <tag group="Usage" tag="LongRest"/>
    </thing>
  <thing id="c5CSorNF01" name="Nourishing Fire" description="Starting at 14th level, your fire spells soothe and restore you. When you expend a spell slot to cast a spell that includes a fire damage roll, you regain hit points equal to the slot’s level + your Charisma modifier." compset="ClSpecial"></thing>
  <thing id="c5CSorFP01" name="Form of the Phoenix" description="At 18th level, you finally master the spark of fire that dances within you. While under the effect of your Mantle of Flame feature, you gain additional benefits:\n\n•  You have a flying speed of 40 feet and can hover.\n•  You have resistance to all damage.\n•  If you use your Phoenix Spark, that feature deals an extra 20 fire damage to each creature." compset="ClSpecial"></thing>
  <thing id="c5CSorSea1" name="Soul of the Sea" description="At 1st level, your tie to the sea grants you the ability to breathe underwater, and you have a swim speed equal to your walking speed." compset="ClSpecial">
    <eval phase="PostLevel" priority="10000"><![CDATA[doneif (tagis[Helper.Disable] <> 0)

var myspeed as number
myspeed = hero.child[Speed].field[tSpeed].value
hero.child[xSwim].field[abValue].value = myspeed]]></eval>
    </thing>
  <thing id="c5CSorSea2" name="Curse of the Sea" description="When you choose this origin at 1st level, you learn the secret of infusing your spells with a watery curse.\nWhen you hit a creature with a cantrip’s attack or when a creature fails a saving throw against your cantrip, you can curse the target until the end of your next turn or until you curse a different creature with this feature.\nOnce per turn when you cast a spell, you can trigger the curse if that spell deals cold or lightning damage to the cursed target or forces it to move. Doing so subjects the target to the appropriate additional effect below, and then the curse ends if the spell isn’t a cantrip (you choose the effect to use if more than one effect applies):\n\n{b}Cold Damage{/b}. If the affected target takes cold damage from your spell, the target’s speed is also reduced by 15 feet until the end of your next turn. If the spell already reduces the target’s speed, use whichever reduction is greater.\n\n{b}Lightning Damage{/b}. If the affected target takes lightning damage from your spell, the target takes additional lightning damage equal to your Charisma modifier.\n\n{b}Forced Movement{/b}. If the target is moved by your spell, increase the distance it is moved by 15 feet." compset="ClSpecial">
    <tag group="abAction" tag="5CN1Attack"/>
    <eval phase="Render" priority="99999">doneif (tagis[Helper.ShowSpec] = 0)
doneif (tagis[Helper.Disable] &lt;&gt; 0)

~ attempts to add effect description to every
~ applicable spell

~ the modifications below do not work because
~ the custdesc field from the spells is blank
~ from the evaluation point of view

~ var extra_txt as string
~ var info as number

~ extra_txt = &quot;{i}Extra effect from {b}Curse of the Sea{/b}{/i}:\n&quot;
~ extra_txt &amp;= &quot;Choose one:\n\n&quot;
~ extra_txt &amp;= &quot;{b}Cold Damage{/b}. If the affected target takes cold damage from your spell, the target’s speed is also reduced by 15 feet until the end of your next turn. If the spell already reduces the target’s speed, use whichever reduction is greater.\n&quot;
~ extra_txt &amp;= &quot;{b}Lightning Damage{/b}. If the affected target takes lightning damage from your spell, the target takes additional lightning damage equal to your Charisma modifier.\n&quot;
~ extra_txt &amp;= &quot;{b}Forced Movement{/b}. If the target is moved by your spell, increase the distance it is moved by 15 feet.&quot;

~ foreach pick in hero from BaseSpell
~   info = pos(eachpick.field[CustDesc].text,&quot;cold&quot;)
~   debug &quot;Info: &quot; &amp; info
~   if ( pos(eachpick.field[CustDesc].text,&quot;cold&quot;) &gt;= 0  ) then
~        eachpick.field[DescAppend].text = extra_txt
~   endif
~ nexteach</eval>
    </thing>
  <thing id="c5CSorSea3" name="Watery Defense" description="At 6th level, you gain resistance to fire damage.\nYou also gain the ability to defend yourself by momentarily assuming a watery form. As a reaction when you are hit by an attack and take bludgeoning, piercing, or slashing damage from it, you can reduce that damage by an amount equal to your sorcerer level plus your Charisma score, and then you can move up to 30 feet without provoking opportunity attacks. Once you use this special reaction, you can’t use it again until you finish a short or long rest." compset="ClSpecial">
    <fieldval field="trkMax" value="1"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Usage" tag="ShortRest"/>
    <tag group="DamageRes" tag="dtFire"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[doneif (tagis[Helper.Disable] <> 0)

perform forward[DamageRes.?]]]></eval>
    </thing>
  <thing id="c5CSorSea4" name="Shifting Form" description="Starting at 14th level, you gain the ability to enter a liquid state while moving. \nWhen you move on your turn, you take only half damage from opportunity attacks, and you can move through any enemy’s space but can’t willingly end your move there. \nOn your turn, you can move through any space that is at least 3 inches in diameter and do so without squeezing. When you stop moving, the regular squeezing rules apply if you’re in a space one size smaller than you. You can’t willingly stop in a space smaller than that, and if you’re forced to do so, you immediately flow to the nearest space that can fit you, back along the path of your movement." compset="ClSpecial"></thing>
  <thing id="c5CSorSea5" name="Water Soul" description="Starting at 18th level, your being is altered by the power of the sea. You gain the following benefits:\n\n•  You no longer need to eat, drink, or sleep.\n•  A critical hit against you becomes a normal hit.\n•  You have resistance to bludgeoning, piercing, and slashing damage." compset="ClSpecial">
    <tag group="DamageRes" tag="dtBludgeon"/>
    <tag group="DamageRes" tag="dtPiercing"/>
    <tag group="DamageRes" tag="dtSlashing"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[doneif (tagis[Helper.Disable] <> 0)

perform forward[DamageRes.?]]]></eval>
    </thing>
  <thing id="c5CSorSBP1" name="Bonus Proficiencies" description="At 1st level, you gain proficiency with shields, simple weapons, and martial weapons." compset="ClSpecial">
    <tag group="ArmProfGrp" tag="Shields"/>
    <tag group="ArmProfGrp" tag="WepSimple"/>
    <tag group="ArmProfGrp" tag="WepMartial"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[doneif (tagis[Helper.ShowSpec] = 0)
doneif (tagis[Helper.Disable] <> 0)

perform forward[ArmProfGrp.?]]]></eval>
    </thing>
  <thing id="c5CSorSMM1" name="Metal Magic" description="Your affinity for metal gives you the option to learn some non-sorcerer spells that focus on weapon attacks. When your Spellcasting feature lets you learn a sorcerer spell of 1st level or higher, you can select the spell from the following list of spells, in addition to the sorcerer spell list. You must otherwise obey all the restrictions for selecting the spell, and it becomes a sorcerer spell for you.\n\n{b}Spell Level   Spell{/b}\n     {i}1st       compelled duel{/i}\n     {i}1st       searing smite{/i}\n     {i}1st       thunderous smite{/i}\n     {i}1st       wrathful smite{/i}\n     {i}2nd       branding smite{/i}\n     {i}2nd       magic weapon{/i}\n     {i}3rd       blinding smite{/i}\n     {i}3rd       elemental weapon{/i}\n     {i}4th       staggering smite{/i}" compset="ClSpecial">
    <eval phase="Final" priority="21000"><![CDATA[doneif (tagis[Helper.ShowSpec] = 0)
doneif (tagis[Helper.Disable] <> 0)

~these vars will hold the tag expressions for spells and cantrips

var cantrip as string
var spell as string
var known as string 
var first as string
var second as string
var third as string
var fourth as string

~ fetch spell expressions
spell = hero.childfound[cHelpSor].field[cSpKnoExpr].text 
known = hero.childfound[cHelpSor].field[cSpellExpr].text 


~ these receive the extra spells for each circle
first = " | thingid.sp5CCompDu | thingid.sp5CSearSm | thingid.sp5CThunSm | thingid.sp5CWrathS"
second = " | thingid.spBranSmit | thingid.spMagiWeap"
third = " | thingid.sp5CBlindS | thingid.sp5CElemWe"
fourth = " | thingid.sp5CStaggS "

if (#levelcount[Sorcerer] >= 1) then
  spell &= first
  known &= first
  if (#levelcount[Sorcerer] >= 3) then
    spell &= second
    known &= second
    if (#levelcount[Sorcerer] >= 5) then
      spell &= third
      known &= third
      if (#levelcount[Sorcerer] >= 7) then
        spell &= fourth
        known &= fourth
      endif
    endif
  endif
endif

hero.childfound[cHelpSor].field[cSpKnoExpr].text = spell
hero.childfound[cHelpSor].field[cSpellExpr].text = known
hero.childfound[cHelpSor].field[cSplBkExpr].text = known]]></eval>
    </thing>
  <thing id="c5CSorSSD1" name="Stone’s Durability" description="At 1st level, your connection to stone gives you extra fortitude. Your hit point maximum increases by 1, and it increases by 1 again whenever you gain a level in this class.\nAs an action, you can gain a base AC of 13 + your Constitution modifier if you aren’t wearing armor, and your skin assumes a stony appearance. This effect lasts until you end it as abonus action, you are incapacitated, or you don armor other than a shield." compset="ClSpecial">
    <fieldval field="abValue2" value="3"/>
    <tag group="abRange" tag="Personal"/>
    <tag group="abAction" tag="Action"/>
    <tag group="User" tag="Activation"/>
    <eval phase="PostLevel" priority="10000" index="2">field[abValue].value += field[xAllLev].value</eval>
    <eval phase="PostAttr" priority="10000"><![CDATA[       doneif (tagis[Helper.ShowSpec] = 0)

       doneif (tagis[Helper.Disable] <> 0)

       herofield[tBonusHP].value += field[abValue].value

       doneif (hero.tagis[Hero.EquipArmor] <> 0)
       doneif (field[abilActive].value = 0)

       #baseac[field[abValue2].value,"Stone's Durability"]
       hero.child[ArmorClass].field[tACDexMod].value = hero.child[aCON].field[aBonus].value]]></eval>
    </thing>
  <thing id="c5CSorSSA1" name="Stone Aegis" description="Starting at 6th level, your command of earth magic grows stronger, allowing you to harness it for your allies’ protection.  \nAs a bonus action, you can grant an aegis to one allied creature you can see within 60 feet of you. The aegis is a dim, gray aura of earth magic that protects the target. Any bludgeoning, piercing, or slashing damage the target takes is reduced by 2 + your sorcerer level divided by 4. This effect lasts for 1 minute, until you use it again, or until you are incapacitated.  \nIn addition, when a creature you can see within 60 feet of you hits the protected target with a melee attack, you can use your reaction to teleport to an unoccupied space you can see within 5 feet of the attacker. You can teleport only if you and the attacker are on the same surface. You can then make one melee weapon attack against the attacker. If that attack hits, it deals an extra 1d10 force damage. This extra damage increases to 2d10 at 11th level and 3d10 at 17th level." compset="ClSpecial">
    <fieldval field="abRange" value="60"/>
    <fieldval field="abDuration" value="1"/>
    <tag group="abRange" tag="Feet"/>
    <tag group="abAction" tag="Bonus"/>
    <tag group="abDuration" tag="Minute"/>
    </thing>
  <thing id="c5CSorSSE1" name="Stone’s Edge" description="Starting at 14th level, your mastery of earth magic allows you to add the force of elemental earth to your spells. When you cast a spell that deals damage, choose one creature damaged by that spell on the round you cast it. That creature takes extra force damage equal to half your sorcerer level. This feature can be used only once per casting of a spell." compset="ClSpecial"></thing>
  <thing id="c5CSorSEMA" name="Earth Master’s Aegis" description="Beginning at 18th level, when you use your Stone’s Aegis to protect an ally, you can choose up to three creatures to gain its benefits." compset="ClSpecial"></thing>
  </document>
